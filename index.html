<!DOCTYPE html>
<html lang="en" style="height: 100%;">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Responsive Layout with Theme Toggle</title>

<style>
    :root {
        --shadow-header-subtle: 0 1px rgba(0, 0, 0, 1);



        --color-sidebar-logo-text: var(--color-text-body);
    --color-sidebar-section-title-text: rgba(224, 224, 224, 0.93); /* Brighter than links */
    --color-sidebar-link-text: rgba(224, 224, 224, 0.67);
    --color-sidebar-link-text-hover: var(--color-text-body); /* Brighter on hover */
    --color-sidebar-link-text-active: var(--color-text-toc-link-active); /* Active color, e.g., dodgerblue */
    --color-sidebar-link-bg-hover: rgba(255, 255, 255, 0.05); /* Very subtle hover background */
    --color-sidebar-link-bg-active: var(--color-search-trigger-hover-bg);
        --color-sidebar-divider: var(--color-border-sidebar);
    --color-sidebar-footer-link-text: var(--color-text-toc-link);
    --color-sidebar-footer-link-text-hover: var(--color-text-toc-link-hover);
    --color-sidebar-logo-svg: var(--color-text-toc-link-active); /* Color for the SVG logo lines */

    /* Dark */
    --color-bg-body: #1b1b1f;
    --color-text-body: #e0e0e0;
    --color-bg-sidebar: #161618;
    --color-border-sidebar: #363636;
    --color-bg-header: #252529;
    --color-border-header: #363636;
    --color-border-toc-line: #555;
    --color-text-toc-link: #aaa;
    --color-text-toc-link-hover: white;
    --color-text-toc-link-active: #a8b1ff;
    --color-button-bg: #444;
    --color-button-text: #e0e0e0;
    --color-button-border: #555;


    /* Footer specific colors - Dark Theme */
    --color-footer-link: hsl(240, 100%, 81%); /* #a3a3ff */
    --color-footer-meta-text: hsl(240, 10%, 60%); /* #9494a3 */
    --color-footer-divider: hsl(240, 10%, 27%); /* #404045 */
    --color-footer-nav-box-border: hsl(240, 10%, 30%); /* #484852 */
    --color-footer-nav-box-bg: transparent;
    /* --- NEW HOVER STATE COLORS FOR NAV BOX --- */
    --color-footer-nav-box-border-hover: hsl(240, 10%, 50%); /* Brighter border, e.g., #757585 */
    --color-footer-nav-box-bg-hover: hsl(240, 10%, 20%);    /* Subtle background fill, e.g., #2e2e33 */
    --color-search-overlay-bg: rgba(10, 10, 10, 0.75); /* Darker overlay for dark theme */
--color-search-modal-bg: #2f2f33; /* Slightly offset from header for depth */
--color-search-text: var(--color-text-body);
--color-search-placeholder-text: var(--color-text-toc-link);
--color-search-border: #4a4a4f;
--color-search-icon: var(--color-text-toc-link);
--color-search-trigger-hover-bg: #38383c;
--color-search-shortcut-bg: rgba(255,255,255,0.08);
--color-search-shortcut-border: var(--color-border-sidebar);
--color-search-shortcut-text: var(--color-text-toc-link);
--color-search-kbd-bg: var(--color-bg-sidebar);
--color-search-kbd-text: var(--color-text-body);
--color-search-kbd-border: var(--color-border-sidebar);

/* --- NEW: Header Navigation Link Colors - Dark Theme --- */
--color-header-nav-link-text: #d8d8de; /* Default color for header nav links */
--color-header-nav-link-text-hover: var(--color-text-body); /* Brighter on hover */
--color-header-nav-link-bg-hover: var(--color-search-trigger-hover-bg); /* Consistent hover bg */
--color-header-nav-link-text-active: var(--color-text-toc-link-active); /* For active/current page link */
--color-header-nav-link-hover-text-blue: var(--color-text-toc-link-active); /* dodgerblue */

/* --- NEW: Dropdown Specific Colors - Dark Theme --- */
--color-dropdown-bg: var(--color-search-modal-bg); /* e.g., #2f2f33 */
--color-dropdown-shadow: 0 4px 12px rgba(0,0,0,0.4), 0 0 0 1px var(--color-border-sidebar); /* Shadow similar to search modal */
--color-dropdown-item-text: var(--color-text-body);
--color-dropdown-item-text-hover: var(--color-text-body); /* Text color might not change, bg does */
--color-dropdown-item-bg-hover: var(--color-search-trigger-hover-bg); /* e.g., #38383c */
--color-dropdown-item-icon: var(--color-text-toc-link);
--color-dropdown-trigger-text: var(--color-header-nav-link-text);
--color-dropdown-trigger-arrow: var(--color-header-nav-link-text);
--color-dropdown-trigger-hover-text: var(--color-header-nav-link-text-hover);
--color-dropdown-trigger-hover-bg: var(--color-header-nav-link-bg-hover);
--color-dropdown-trigger-active-bg: var(--color-header-nav-link-bg-hover); /* When dropdown is open */
--color-header-nav-link-text-active: var(--color-text-toc-link-active);

/* --- NEW: Scrollbar Colors for TOC - Dark Theme --- */
--toc-scrollbar-track-bg: hsl(240, 6%, 17%);    /* A bit lighter than TOC bg (#202020 is ~11% lightness) */
--toc-scrollbar-thumb-bg: hsl(240, 6%, 40%);    /* A noticeable but dark grey */
--toc-scrollbar-thumb-hover-bg: hsl(240, 6%, 50%); /* Slightly lighter for hover */



--main-scrollbar-track-bg: hsl(240, 6%, 17%);
--main-scrollbar-thumb-bg: hsl(240, 6%, 40%);
--main-scrollbar-thumb-hover-bg: hsl(240, 6%, 50%);

}




    html.light-theme { /* light-theme */

        --shadow-header-subtle: 0 1px 2px rgba(0, 0, 0, 0.04); /* offset-x | offset-y | blur-radius | color (black with 4% opacity) */

        --color-text-toc-link-active: rgb(14, 41, 129);
        --color-sidebar-logo-text: var(--color-text-body);
    --color-sidebar-section-title-text: rgba(51, 51, 51, 0.93);
    --color-sidebar-link-text: rgba(51, 51, 51, 0.67);
    --color-sidebar-link-text-hover: var(--color-text-body);
    --color-sidebar-link-text-active: var(--color-text-toc-link-active);
    --color-sidebar-link-bg-hover: rgba(0, 0, 0, 0.04);
    --color-sidebar-link-bg-active: var(--color-search-trigger-hover-bg);
    --color-sidebar-divider: var(--color-border-sidebar);
    --color-sidebar-footer-link-text: var(--color-text-toc-link);
    --color-sidebar-footer-link-text-hover: var(--color-text-toc-link-hover);
    --color-sidebar-logo-svg: var(--color-text-toc-link-active);

    --color-bg-body: #f4f4f4;
    --color-text-body: #333333;
    --color-bg-sidebar: #e9e9e9;
    --color-border-sidebar: #cccccc;
    --color-bg-header: #e0e0e0;
    --color-border-header: #cccccc;
    --color-border-toc-line: #bbbbbb;
    --color-text-toc-link: #555555;
    --color-text-toc-link-hover: #222222;
    --color-button-bg: #e0e0e0;
    --color-button-text: #333;
    --color-button-border: #ccc;

    --color-footer-link: hsl(210, 70%, 50%);
    --color-footer-meta-text: hsl(220, 10%, 45%);
    --color-footer-divider: hsl(210, 20%, 88%);
    --color-footer-nav-box-border: hsl(210, 20%, 85%);
    --color-footer-nav-box-bg: transparent;

    --color-footer-nav-box-border-hover: hsl(210, 20%, 70%);
    --color-footer-nav-box-bg-hover: hsl(210, 20%, 94%);
    --color-search-overlay-bg: rgba(60, 60, 70, 0.4); /* Semi-transparent dark overlay for light theme provides contrast */
--color-search-modal-bg: #ffffff;
--color-search-text: var(--color-text-body);
--color-search-placeholder-text: var(--color-text-toc-link);
--color-search-border: #dce1e7;
--color-search-icon: var(--color-text-toc-link);
--color-search-trigger-hover-bg: #d8d8de;
--color-search-shortcut-bg: rgba(0,0,0,0.04);
--color-search-shortcut-border: var(--color-border-sidebar);
--color-search-shortcut-text: var(--color-text-toc-link);
--color-search-kbd-bg: var(--color-bg-sidebar);
--color-search-kbd-text: var(--color-text-body);
--color-search-kbd-border: var(--color-border-sidebar);

/* --- NEW: Header Navigation Link Colors - Light Theme (can reuse dark if appropriate) --- */
/* These will correctly use the light theme's --color-text-toc-link, etc. */
--color-header-nav-link-text: var(--color-text-toc-link);
--color-header-nav-link-text-hover: var(--color-text-body);
--color-header-nav-link-bg-hover: var(--color-search-trigger-hover-bg);
--color-header-nav-link-text-active: var(--color-text-toc-link-active);

--color-header-nav-link-hover-text-blue: var(--color-text-toc-link-active);

/* --- NEW: Dropdown Specific Colors - Light Theme --- */
--color-dropdown-bg: var(--color-search-modal-bg); /* e.g., #ffffff */
--color-dropdown-shadow: 0 4px 12px rgba(0,0,0,0.1), 0 0 0 1px var(--color-border-sidebar);
--color-dropdown-item-text: var(--color-text-body);
--color-dropdown-item-text-hover: var(--color-text-body);
--color-dropdown-item-bg-hover: var(--color-search-trigger-hover-bg); /* e.g., #d8d8de */
--color-dropdown-item-icon: var(--color-text-toc-link);
--color-dropdown-trigger-text: var(--color-header-nav-link-text);
--color-dropdown-trigger-arrow: var(--color-header-nav-link-text);
--color-dropdown-trigger-hover-text: var(--color-header-nav-link-text-hover);
--color-dropdown-trigger-hover-bg: var(--color-header-nav-link-bg-hover);
--color-dropdown-trigger-active-bg: var(--color-header-nav-link-bg-hover);
--color-header-nav-link-text-active: var(--color-text-toc-link-active);

/* --- NEW: Scrollbar Colors for TOC - Light Theme --- */
--toc-scrollbar-track-bg: hsl(210, 15%, 94%);    /* Slightly darker than TOC bg (#e9e9e9 is ~91% lightness) */
--toc-scrollbar-thumb-bg: hsl(210, 12%, 75%);    /* A noticeable but light grey */
--toc-scrollbar-thumb-hover-bg: hsl(210, 12%, 65%); /* Slightly darker for hover */


--main-scrollbar-track-bg: hsl(210, 15%, 94%);
--main-scrollbar-thumb-bg: hsl(210, 12%, 75%);
--main-scrollbar-thumb-hover-bg: hsl(210, 12%, 65%);
}

/* ... (rest of your existing CSS) ... */

html{
    box-sizing: border-box;
    height: 100%;
    }
    *, *:before, *:after {
    box-sizing: inherit;
    }
    body {
    height: 100%;
    margin: 0;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI',
        Roboto, Helvetica, Arial, sans-serif;
    background-color: var(--color-bg-body);
    color: var(--color-text-body);
    font-size: 16px;
    display: flex;
    flex-direction: row;
    width: 100%;
    transition: background-color 0.3s ease, color 0.3s ease;
    }

    .left-sidebar {
    flex-basis: 16rem;
    flex-grow: 0;
    flex-shrink: 0;
    border-right: 1px solid var(--color-border-sidebar);
    background-color: var(--color-bg-sidebar);
    transition: background-color 0.3s ease, border-color 0.3s ease, transform 0.3s ease-in-out;
    overflow: hidden; /* Prevent this from scrolling, sidebar-nav will scroll */
    padding: 0; /* Remove previous padding, will control internally */
    display: flex;
    flex-direction: column;
    }

    .main-area-wrapper {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    overflow-y: auto; /* <<< KEY: This makes this wrapper scrollable */
height: 100vh; /* <<< KEY: Ensure it has a defined height to enable scrolling within it */
scrollbar-width: thin;
scrollbar-color: var(--main-scrollbar-thumb-bg) var(--color-bg-body); /* Use your existing variables */

    }

    .main-area-wrapper::-webkit-scrollbar {
width: 10px; /* Increased from 8px to make more room for the gap */
}

.main-area-wrapper::-webkit-scrollbar-track {
background: var(--main-scrollbar-track-bg);
}

.main-area-wrapper::-webkit-scrollbar-thumb {
background-color: var(--main-scrollbar-thumb-bg);
border-radius: 10px; /* Or your preferred radius, e.g., 6px for consistency */
/* This border IS the "gap". Its color is the track's background. */
border: 3px solid var(--main-scrollbar-track-bg); /* Increased from 2px */
}

.main-area-wrapper::-webkit-scrollbar-thumb:hover {
background-color: var(--main-scrollbar-thumb-hover-bg);
}

/* Ensure content-toc-row and its children can expand naturally */
.content-toc-row {
flex-grow: 1; /* Allows content-area and toc-container to fill space */
display: flex;
flex-direction: row;
/* REMOVE: overflow: hidden; if it was here, to allow vertical expansion */
}


.app-header {
height: 4rem;
flex-shrink: 0;
padding: 0 1rem; /* Adjusted padding for mobile */
background-color: var(--color-bg-body);       /* Changed in the previous step */
border-bottom: 0px solid var(--color-border-header); /* This remains the primary distinguishable line */
box-shadow: var(--shadow-header-subtle);      /* ADDED: Applies the new subtle shadow */
display: flex;
align-items: center;
/* MODIFIED: Ensure box-shadow is included in the transition for theme changes */
transition: background-color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
position: sticky;
top: 0;
z-index: 990; /* Ensure it's above content but below mobile sidebar/overlay */
}
/* Desktop: Space between logo (if it were a direct child) and header-actions */
.app-header > div:not(.header-actions):not(.mobile-menu-button):not(.mobile-header-logo) { /* MODIFIED */
margin-right: 1rem;
}


    #content-area {
    flex-grow: 3;
    flex-basis: 0;
    padding: 1.5rem;
    }
#content-area::-webkit-scrollbar {
width: 8px; /* Or your preferred width */
}



#toc-container {
flex-basis: 13rem; /* Narrower ToC */
flex-shrink: 0;
padding: 1.5rem 1rem; /* Reduced padding */
overflow-y: auto; overflow-x: hidden;
height: calc(100vh - 3.75rem);
position: sticky; 
top: 3.75rem;
/* border-left: 1px solid var(--color-border-sidebar); */ /* Removed left border for cleaner look */
scrollbar-width: none;  /* For Firefox: hides the scrollbar completely */
/* --- SCROLLBAR STYLING --- */
}
#toc-container::-webkit-scrollbar {
width: 6px;
}
#toc-container::-webkit-scrollbar-track {
background: transparent; /* Or var(--color-bg-sidebar) if you want it visible */
}
#toc-container::-webkit-scrollbar-thumb {
background-color: var(--toc-scrollbar-thumb-bg);
border-radius: 3px;
}
#toc-container::-webkit-scrollbar-thumb:hover {
background-color: var(--toc-scrollbar-thumb-hover-bg);
}
/* --- END SCROLLBAR STYLING --- */


#toc-links {
position: relative; /* CRITICAL for marker positioning */
border-left: 2px solid var(--color-border-toc-line); /* The faint guide line */
display: flex;
flex-direction: column;
transition: border-color 0.3s ease;
/* NO padding-left on #toc-links itself */
}

#toc-links a {
    display: block;
    /* Distribute the total vertical padding equally */
    padding-top: 0.65rem;
    padding-bottom: 0.65rem;
    /* Keep horizontal padding and other properties as they were */
    padding-left: 1rem;
    padding-right: 0; /* Assuming it was 0 or not set, based on original calc */
    color: var(--color-text-toc-link);
    text-decoration: none;
    margin-bottom: 0; /* Crucial: keep this at 0 */
    white-space: normal;
    font-size: 0.9rem;
    position: relative; /* Good practice */
}

#toc-links a.active {
color: var(--color-text-toc-link-active); /* Adjusted for better visibility against default link color */
/* It will inherit the padding-left: 1rem; from the general 'a' rule, which is what we want */
}

#toc-active-marker {
position: absolute;
top: 0; /* JavaScript will update this */
left: -2px; /* <<< THIS IS THE KEY CHANGE */
            /* Moves the marker 2px to the left, covering the parent's border-left */
width: 2px; /* Match the width of #toc-links's border-left */
height: 0; /* JavaScript will update this */
background-color: var(--color-text-toc-link-active); /* Active color */
transition: top 0.2s ease-in-out, height 0.2s ease-in-out, opacity 0.2s ease-in-out;
}
#toc-links a:hover {
    color: var(--color-text-toc-link-hover);
    }
    #content-area h2 {
    margin-top: 2rem;
    margin-bottom: 1rem;
    padding-top: 5rem; /* Considers 4rem header + 1rem buffer */
    color: var(--color-text-body);
    }
    #content-area h2:first-of-type {
        margin-top: 0;
    }


    #content-area p {
    line-height: 1.6;
    margin-bottom: 1rem;
    color: var(--color-text-body);
    }

    .theme-toggle-button {
    padding: 0.4rem; /* Keep padding for click area and icon spacing */
    background-color: transparent; /* Make background transparent by default */
    color: var(--color-text-toc-link); /* Use a more subdued color, like ToC links */
    border: 1px solid transparent;   /* Make border transparent by default */
    border-radius: 6px; /* Slightly rounder for a softer look, optional */
    cursor: pointer;
    transition: background-color 0.2s ease, color 0.2s ease; /* Smoother, quicker transition */

    display: inline-flex;
    align-items: center;
    justify-content: center;
    line-height: 0;


}



.theme-toggle-button:hover,
.theme-toggle-button:focus-visible {
    color: var(--color-text-body); /* Make icon more prominent on hover/focus */
}


/* If you want a very subtle outline for focus-visible on top of the background change: */
/*
.theme-toggle-button:focus-visible {
    outline: 1px solid var(--color-text-toc-link-active);
    outline-offset: 2px;
}
*/    .theme-toggle-button .theme-icon {
display: none; /* Hide both icons by default */
}

/* When dark theme is active (default, or html.dark-theme) */
/* Show the MOON icon, because the current theme is dark. */
html:not(.light-theme) .theme-toggle-button .theme-icon-moon,
html.dark-theme .theme-toggle-button .theme-icon-moon { /* If you also use .dark-theme class */
display: inline-flex;
}

/* When light theme is active */
/* Show the SUN icon, because the current theme is light. */
html.light-theme .theme-toggle-button .theme-icon-sun {
display: inline-flex;
}


    .page-meta-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
    font-size: 0.875rem;
    flex-wrap: wrap; /* Allow items to wrap on small screens */
    gap: 0.5rem; /* Add gap for wrapped items */
    }

    .edit-page-link {
    color: var(--color-footer-link);
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    transition: color 0.2s ease;
    }
    .edit-page-link:hover {
    text-decoration: underline;
    }
    .edit-page-link svg {
    width: 1.1em;
    height: 1.1em;
    margin-right: 0.4em;
    vertical-align: middle;
    }

    .last-updated-text {
    color: var(--color-footer-meta-text);
    transition: color 0.3s ease;
    }

    .footer-divider-line {
    border: none;
    border-top: 1px solid var(--color-footer-divider);
    margin-top: 1rem;
    margin-bottom: 1.5rem;
    transition: border-color 0.3s ease;
    }

    .page-navigation-boxes {
    display: flex;
    justify-content: space-between;
    gap: 1rem;
    }

    .nav-box {
    flex: 1;
    padding: 1rem;
    border: 1px solid var(--color-footer-nav-box-border);
    border-radius: 8px;
    background-color: var(--color-footer-nav-box-bg);
    transition: border-color 0.2s ease, background-color 0.2s ease;
    cursor: pointer;
    min-width: 0; /* Allow flex items to shrink properly */
    }
    .nav-box:hover {
         border-color: var(--color-text-toc-link-active); /* Use active color for consistency */
}

    .nav-box-label {
    display: block;
    font-size: 0.875rem;
    color: var(--color-footer-meta-text);
    margin-bottom: 0.25rem;
    transition: color 0.3s ease;
    }

    .nav-box-link {
    display: block;
    font-size: 1rem;
    color: var(--color-footer-link);
    text-decoration: none;
    font-weight: 500;
    transition: color 0.2s ease;
    word-break: break-word; /* Prevent long links from breaking layout */
    }


    .next-page-box {
    text-align: right;
    }
    .next-page-box .nav-box-label,
    .next-page-box .nav-box-link {
        text-align: right;
    }
    .previous-page-box .nav-box-label,
    .previous-page-box .nav-box-link {
        text-align: left;
    }
    /* Header Actions Wrapper */
    .header-actions {
      display: flex;
      align-items: center;
      flex-grow: 1; /* Desktop: take remaining space */
      justify-content: flex-end; /* Desktop: align items to the right */
      gap: 0.75rem; /* Desktop: gap between search and right group */
    }

    .header-actions-right { /* Contains desktop links, theme, github */
      display: flex;
      align-items: center;
      gap: 0.5rem; 
    }


    .header-nav-link {
      padding: 0.4rem 0.8rem; /* Adjust padding as needed */
      border-radius: 6px; /* Consistent with other interactive elements */
      text-decoration: none;
      color: var(--color-header-nav-link-text); /* Use variable */
      font-weight: 500; /* A common weight for nav items */
      font-size: 0.9rem; /* Slightly smaller than body text, adjust as needed */
      line-height: 1.5; /* Ensure consistent line height */
      transition: color 0.2s ease, background-color 0.2s ease;
      display: inline-flex;
      align-items: center;
      white-space: nowrap; /* Prevent wrapping if text is long */
    }

.header-nav-link:hover,
.header-nav-link:focus-visible {
  color: var(--color-header-nav-link-hover-text-blue) !important; /* Explicitly use variable */
  background-color: transparent; /* Explicitly transparent */
  text-decoration: none;
  outline: none;
}

.header-nav-link.active {
    color: var(--color-header-nav-link-text-active);
}

    /* Ensure visited links don't turn purple/blue by default browser styles */
    .header-nav-link:visited {
        color: var(--color-header-nav-link-text);
    }


#themeToggle.theme-toggle-button::before,
#themeToggle.theme-toggle-button::after {
content: '';
display: inline-block;
width: 1px;
height: 1rem; /* Adjust height as needed */
background-color: var(--color-border-sidebar); /* Separator color */
vertical-align: middle; /* Helps with alignment */
}

/* --- Separator BEFORE the Theme Toggle icon --- */
#themeToggle.theme-toggle-button::before {
/* margin-left: 0.5rem; /* Only if there's an element before this group */
margin-right: 0.75rem; /* Space between this first separator and the Theme Toggle icon */
}

/* --- Separator AFTER Theme Toggle icon (which is BETWEEN Theme Toggle and GitHub) --- */
#themeToggle.theme-toggle-button::after {
margin-left: 0.75rem;  /* Space between Theme Toggle icon and this second separator */
}

/* Search Trigger Button in Header */
.search-trigger-button {
    display: flex;
    align-items: center;
    padding: 0.4rem 0.8rem;
    background-color: transparent; /* Use button bg for consistency or keep transparent */
    color: var(--color-text-toc-link); /* More subtle than body text */
    border: 1px solid var(--color-search-shortcut-border);
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.9rem;
    transition: background-color 0.2s ease, border-color 0.2s ease, color 0.2s ease;
    margin-right: auto;
}

.search-trigger-button:hover {
    border-color: var(--color-search-border); /* Brighter border on hover */
    color: var(--color-text-body);       /* Brighter text on hover */
    /* No outline style here, it will inherit from the base or browser default */
}

.search-trigger-button:focus-visible {
    /* When focused via keyboard (or programmatically like after ESC): */
    /* Revert color and border to the button's default state */
    color: var(--color-text-toc-link);
    border-color: var(--color-search-shortcut-border);

    outline: none; /* This removes the blue outline as per your first request */
}

/* --- ADD THIS NEW RULE --- */
/* Ensures hover styles apply even when focus-visible is also active */
.search-trigger-button:focus-visible:hover {
    border-color: var(--color-search-border); /* Brighter (same as :hover) */
    color: var(--color-text-body);       /* Brighter (same as :hover) */
    /* outline: none; (implicitly, it will still have no outline from the rule above) */
}
/* --- END OF NEW RULE --- */

.search-trigger-icon-svg {
    margin-right: 0.5em;
    stroke: currentColor; /* Inherits color from button */
}
.search-shortcut-hint {
margin-left: 0.75rem;
padding: 0.1rem 0.4rem;
border-radius: 4px;
font-size: 0.8em;
background-color: var(--color-search-shortcut-bg);
border: 1px solid var(--color-search-shortcut-border);
color: var(--color-search-shortcut-text);
line-height: 1.2;
}


/* Search Overlay */
.search-overlay {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background-color: var(--color-search-overlay-bg);
display: flex; /* Changed from none to flex for direct alignment */
align-items: flex-start;
justify-content: center;
padding-top: 15vh; /* Position modal from top, gives space to "fall" into */
z-index: 10000; /* High z-index */

opacity: 0;
visibility: hidden; /* Hidden by default */
/* Smooth transition for opacity, visibility changes instantly based on active class */
transition: opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1), visibility 0s linear 0.3s;
}

.search-overlay.active {
opacity: 1;
visibility: visible;
transition-delay: 0s; /* Apply visibility change immediately when .active is added */
}

/* Search Modal */
.search-modal {
background-color: var(--color-search-modal-bg);
padding: 1rem; /* Adjusted for potentially smaller screens */
border-radius: 8px;
box-shadow: 0 15px 40px rgba(0,0,0,0.3), 0 0 0 1px var(--color-search-border); /* Softer shadow + border */
width: 90%;
max-width: 560px; /* Slightly narrower */

/* Animation: Starts slightly scaled down and offset upwards, fades in */
opacity: 0;
transform: translateY(-25px) scale(0.98);
transition: opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1), transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
transition-delay: 0.05s; /* Modal animation starts slightly after overlay fades in */
}

.search-overlay.active .search-modal {
opacity: 1;
transform: translateY(0) scale(1);
}

.search-input-container {
display: flex;
align-items: center;
border-bottom: 1px solid var(--color-search-border);
padding-bottom: 0.75rem;
margin-bottom: 1rem;
}

.search-modal-icon {
color: var(--color-search-icon);
margin-right: 0.8rem;
flex-shrink: 0;
}

.search-input {
flex-grow: 1;
font-size: 1rem; /* Slightly smaller for mobile */
border: none;
outline: none;
background-color: transparent;
color: var(--color-search-text);
height: 2.5rem; /* Explicit height for better alignment */
}

.search-input::placeholder {
color: var(--color-search-placeholder-text);
opacity: 1; /* Ensure placeholder is fully visible */
}

.search-close-button {
background: transparent;
border: 1px solid transparent; /* Keep space but hide border */
color: var(--color-text-toc-link);
padding: 0.4rem 0.6rem;
font-size: 0.9rem;
border-radius: 6px;
cursor: pointer;
margin-left: 0.75rem;
transition: background-color 0.2s ease, color 0.2s ease;
}
.search-close-button:hover {
    background-color: var(--color-search-trigger-hover-bg);
    color: var(--color-text-body);
}

.search-close-button kbd {
background-color: var(--color-search-kbd-bg);
border: 1px solid var(--color-search-kbd-border);
color: var(--color-search-kbd-text);
padding: 0.2rem 0.45rem;
border-radius: 4px;
font-size: 0.8em;
box-shadow: 0 1px 1px rgba(0,0,0,0.1);
display: inline-block; /* Ensure padding and border are respected well */
}

.search-results-container {
min-height: 80px; /* Placeholder for results area */
/* For actual results: max-height: 50vh; overflow-y: auto; */
}

.search-results-placeholder {
color: var(--color-text-toc-link);
text-align: center;
padding: 1.5rem 0;
font-size: 0.9rem;
}

.icon-button, /* General styles if used on <button> */
a.icon-button   /* Specific styles for <a> tags with this class */ {
padding: 0.4rem;
background-color: transparent;
color: var(--color-text-toc-link); /* THIS SETS THE GREY COLOR */
border: 1px solid transparent;
border-radius: 6px;
cursor: pointer;
transition: background-color 0.2s ease, color 0.2s ease;
display: inline-flex;
align-items: center;
justify-content: center;
line-height: 0;
text-decoration: none !important; /* REMOVES THE UNDERSCORE */
}

/* Hover and Focus states for the <a> tag */
a.icon-button:hover,
a.icon-button:focus-visible {
color: var(--color-text-body); /* Changes color on hover/focus */
/* background: transparent; /* This was overriding the bg color change */
}

/* Explicitly style visited state for <a> tag to prevent purple/blue */
a.icon-button:visited {
color: var(--color-text-toc-link); /* Keep visited same color as normal */
text-decoration: none !important;
}

/* Style for the SVG inside the icon button */
.icon-button svg {
width: 24px;
height: 24px;
/* The fill="currentColor" in your SVG path will use the 'color' from a.icon-button */
}

.header-dropdown-container {
position: relative;
display: inline-block; /* or inline-flex if that's what you use */
}

.header-dropdown-trigger {
    display: inline-flex;
    align-items: center;
    padding: 0.4rem 0.8rem;
    border-radius: 6px;
    background-color: transparent;
    color: var(--color-header-nav-link-text); /* Use variable */
    border: none;
    font-family: inherit;
    font-size: 0.9rem;
    font-weight: 500;
    cursor: pointer; /* Still good to have a pointer */
    transition: background-color 0.2s ease, color 0.2s ease;
    white-space: nowrap;

}

/* MODIFIED: Header Navigation Link Hover Effect */

.header-dropdown-trigger .dropdown-arrow-icon {
    margin-left: 0.35rem;
    transition: transform 0.2s ease-out, stroke 0.2s ease-out; /* MODIFIED: Added stroke to transition */
    transform: rotate(90deg); /* ADDED: Makes the default ">" arrow point DOWN "v" */
    stroke: var(--color-header-nav-link-text);
    width: 1em; /* Adjust size */
    height: 1em;
    
}

 .header-dropdown-container:hover .header-dropdown-trigger .dropdown-arrow-icon,
.header-dropdown-trigger[aria-expanded="true"] .dropdown-arrow-icon {
    transform: rotate(-90deg); /* Change to -90 degrees for UP arrow */
    stroke: var(--color-sidebar-link-text);           ; /* Match text color when open/hover */
}

.header-dropdown-trigger:focus-visible .dropdown-arrow-icon {
    transform: rotate(-90deg); /* Pointing UP */
}

.header-dropdown-menu {
position: absolute;
top: 100%; 
left: 50%;              /* <<< ADD: Position the left edge of the menu at the center of the container */
transform: translateX(-50%) translateY(-10px); /* <<< MODIFY: Pull menu left by half its own width, keep existing Y transform */
                                            /* If the menu is visible (on hover), transform will be translateX(-50%) translateY(0) */
background-color: var(--color-dropdown-bg);
border-radius: 8px;
box-shadow: var(--color-dropdown-shadow);
padding: 0.5rem;
min-width: 180px; /* Adjust as needed */
z-index: 1000;
list-style: none;
margin: 0;

opacity: 0;
visibility: hidden;
/* The Y transform is part of the open/close animation */
transition: opacity 0.15s ease-out,
            transform 0.15s ease-out, /* Ensure transform is part of the transition */
            visibility 0s linear 0.15s;
pointer-events: none;
}



.header-dropdown-container:hover .header-dropdown-trigger {
    color: var(--color-sidebar-link-text);           /* Ensures text color matches hover state */
}


/* --- THIS IS THE KEY CHANGE FOR HOVER --- */
.header-dropdown-container:hover .header-dropdown-menu,
.header-dropdown-menu:hover {
    opacity: 1;
    visibility: visible;
    transform: translateX(-50%) translateY(0);
    transition-delay: 0s;
    pointer-events: auto;
}


.header-dropdown-item {
    display: flex;
    align-items: center;
    justify-content: space-between; /* Pushes icon to the right */
    padding: 0.6rem 0.75rem;
    color: var(--color-dropdown-item-text);
    text-decoration: none;
    border-radius: 6px; /* Rounded corners for items too */
    font-size: 0.9rem;
    transition: background-color 0.2s ease, color 0.2s ease;
    white-space: nowrap;
}

.header-dropdown-item:hover,
.header-dropdown-item:focus-visible {
    background-color: var(--color-dropdown-item-bg-hover);
    color: var(--color-dropdown-item-text-hover); /* Though might be same as default */
    outline: none;
}

.header-dropdown-item .external-link-icon {
    margin-left: 0.75rem;
    stroke: var(--color-dropdown-item-icon);
    opacity: 0.7; /* Make it slightly less prominent */
}
.header-dropdown-item:hover .external-link-icon,
.header-dropdown-item:focus-visible .external-link-icon {
    opacity: 1;
}

/* --- Left Sidebar Enhanced Styles --- */
.sidebar-brand {
padding-left: 1.25rem;
padding-top: 1.25rem;
padding-bottom: 0; /* Adjusted as divider handles bottom space */
flex-shrink: 0; /* Prevent shrinking */
}
.sidebar-logo-link { /* This was a.header-nav-link, changed for clarity and specific styling */
display: inline-flex;
align-items: center;
text-decoration: none;
color: var(--color-sidebar-logo-text);
font-size: 1.125rem; /* ~18px */
font-weight: 600;
transition: color 0.2s ease;
padding: 0.4rem 0; /* Give it some minimal padding like other header links */
}
.sidebar-logo-link:hover {
color: var(--color-text-body);
}


.sidebar-logo-link .logo-svg {
width: 28px;
height: 28px;
margin-right: 0.65rem;
color: var(--color-sidebar-logo-svg); /* Uses the CSS variable for stroke */
}

/* Sidebar Dividers */
.sidebar-divider {
border: none;
height: 1px;
background-color: var(--color-sidebar-divider);
margin: 0 1.25rem; /* Horizontal padding to match content */
flex-shrink: 0; /* Prevent shrinking */
}
.logo-divider {
margin-top: 0.6rem;
margin-bottom: 0.75rem;
}
.section-divider {
margin-top: 0.75rem;
margin-bottom: 0.75rem;
}
/* Hide divider if it's the very last child after a nav section, before the footer */
.sidebar-nav > .sidebar-nav-section:last-of-type + .section-divider {
display: none;
}



/* Sidebar Navigation Area */
.sidebar-nav {
flex-grow: 1; /* Allows nav to take up available space, pushing footer down */
overflow-y: auto; /* This part scrolls if content is too long */
padding: 0 0 0.75rem; /* Bottom padding before footer or end of sidebar */
scrollbar-width: thin;
scrollbar-color: var(--toc-scrollbar-thumb-bg) var(--color-bg-sidebar);
}
.sidebar-nav::-webkit-scrollbar {
width: 6px;
}
.sidebar-nav::-webkit-scrollbar-track {
background: transparent; /* Track often transparent in sidebars */
}
.sidebar-nav::-webkit-scrollbar-thumb {
background-color: var(--toc-scrollbar-thumb-bg);
border-radius: 3px;
}
.sidebar-nav::-webkit-scrollbar-thumb:hover {
background-color: var(--toc-scrollbar-thumb-hover-bg);
}


.sidebar-nav-section {
padding: 0 1.25rem; /* Horizontal padding for section content */
/* is-open class will be handled by JS */
}

/* REPLACED .sidebar-section-title with .sidebar-section-toggle */
.sidebar-section-toggle {
display: flex;
justify-content: space-between;
align-items: center;
width: 100%;
padding: 0.5rem 0; /* Adjust padding for better click area */
margin-top: 0.75rem;
margin-bottom: 0; /* Content div will handle spacing */
font-size: 0.9375rem; /* ~15px */
font-weight: 600;
color: var(--color-sidebar-section-title-text);
background-color: transparent;
border: none;
text-align: left;
cursor: pointer;
font-family: inherit; /* Ensure button inherits font */
transition: color 0.2s ease;
}
.sidebar-section-toggle:hover {
color: var(--color-text-body); /* Or a specific hover color for title */
}
.sidebar-nav-section:first-child > .sidebar-section-toggle {
margin-top: 0.25rem;
}

.sidebar-section-arrow {
width: 1em;
height: 1em;
stroke: currentColor; /* Inherits color from button */
transition: transform 0.25s ease-out;
/* Default (collapsed state): Rotate the "down arrow" to point RIGHT */
transform: rotate(-90deg);
}
.sidebar-nav-section.is-open > .sidebar-section-toggle .sidebar-section-arrow {
/* Expanded state: Rotate the "down arrow" to point DOWN (no effective rotation) */
transform: rotate(0deg);
}


/* Collapsible Content Area */
.sidebar-section-content {
overflow: hidden;
max-height: 0; /* Collapsed by default (JS will add is-open to parent to override) */
transition: max-height 0.3s ease-out,
            padding-top 0.3s ease-out,
            padding-bottom 0.3s ease-out;
padding-top: 0;
padding-bottom: 0;
}
.sidebar-nav-section.is-open > .sidebar-section-content {
/* Estimate a large enough max-height or calculate dynamically if needed */
max-height: 1000px; /* Adjust if you have very long sections */
padding-top: 0.4rem; /* Space between title and links when open */
padding-bottom: 0.2rem; /* Space after links when open */
}

.sidebar-nav-links {
list-style: none;
padding-left: 0em; /* Indent for the links under a title */
margin: 0;
}
.sidebar-nav-links li {
margin: 0; /* Remove default li margin if any */
}
.sidebar-link {
display: block;
padding-top: 0.4rem;
padding-bottom: 0.4rem;
font-size: 0.875rem; /* ~14px */
color: var(--color-sidebar-link-text);
text-decoration: none;
border-radius: 6px;
transition: color 0.2s ease, background-color 0.2s ease, font-weight 0.2s ease;
font-weight: 500;
line-height: 1.4;
margin-bottom: 0.1rem; /* Small gap between links */
padding-left: 1rem;
font-weight: 600;
}
.sidebar-link:hover {
    color: var(--color-sidebar-link-text-hover); /* Use theme-aware hover text color */
    background-color: var(--color-search-trigger-hover-bg);
}

/* Sidebar Footer Link Area */
.sidebar-footer {
padding: 0.75rem 1.25rem 1.25rem;
margin-top: auto; /* Pushes to bottom if .sidebar-nav doesn't fill space */
border-top: 1px solid var(--color-sidebar-divider);
flex-shrink: 0; /* Prevent shrinking */
}
.sidebar-footer a {
font-size: 0.8125rem; /* ~13px */
color: var(--color-sidebar-footer-link-text);
text-decoration: none;
transition: color 0.2s ease;
display: block; /* Make the link take full width for easier clicking */
}
.sidebar-footer a:hover {
color: var(--color-sidebar-footer-link-text-hover);
text-decoration: underline;
}

.toc-container-header {
    margin-bottom: 0.5rem;
    margin-top: 0;
    font-weight: 600;
}

/* --- Mobile Menu Button --- */
.mobile-menu-button {
display: none; /* Hidden by default, shown in media query */
padding: 0.4rem;
background-color: transparent;
color: var(--color-text-body);
border: 1px solid transparent;
border-radius: 6px;
cursor: pointer;
line-height: 0; /* For icon alignment */
margin-right: 0.75rem; /* Space from other header items */
}
.mobile-menu-button svg {
width: 24px;
height: 24px;
stroke: currentColor;
}
.mobile-menu-button:hover {
background-color: var(--color-search-trigger-hover-bg);
}

/* Mobile ToC Toggle Button */
.mobile-toc-toggle {
    display: none; /* Hidden by default */
}
/* Page Overlay for Mobile Sidebar / ToC */
.page-overlay {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background-color: rgba(0,0,0,0.5); /* Semi-transparent black */
z-index: 10005; /* Below sidebar, above content */
display: none; /* Shown by JS when sidebar is open */
opacity: 0;
transition: opacity 0.3s ease-in-out;
}
/* No need for .mobile-sidebar-open .page-overlay here, JS handles display and opacity directly */


/* Prevent body scroll when mobile sidebar is open */
body.mobile-sidebar-open,
body.mobile-toc-open { /* ADDED: Also prevent scroll if ToC panel is open */
overflow: hidden;
}

.mobile-header-logo {
    display: none; /* Hidden by default on desktop */
    align-items: center; /* Vertically align content if logo div is flex */
}


.mobile-header-logo .sidebar-logo-link {
    display: inline-flex;
    align-items: center;
    text-decoration: none;
    color: var(--color-text-body); /* Use body text color for header logo, or var(--color-sidebar-logo-text) if preferred */
    font-size: 1.125rem; /* Consistent with sidebar logo */
    font-weight: 600;
    padding: 0; /* Remove padding that might come from .sidebar-logo-link */
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.mobile-header-logo .sidebar-logo-link .logo-svg { /* If you use an SVG logo */
    width: 28px;
    height: 28px;
    margin-right: 0.65rem;
    color: var(--color-text-body); /* Or var(--color-sidebar-logo-svg) */
}


/* --- Media Query for Responsiveness (e.g., Tablets and Phones) --- */
@media (max-width: 992px) {
.app-header {
    padding: 0 0.75rem; 
    justify-content: flex-start; /* Align items to the start, logo will grow */
}
.app-header > div:not(.header-actions):not(.mobile-menu-button):not(.mobile-header-logo) {
  margin-right: 0.5rem;
}


.mobile-menu-button {
    display: inline-flex; 
    flex-shrink: 0;
    margin-right: 0.5rem; /* Space between hamburger and logo */
}
.mobile-header-logo {
    display: inline-flex;
    flex-grow: 1; /* Logo takes available space */
    justify-content: flex-start; /* Logo content (text/svg) aligns left within its container */
    margin-right: 0.5rem; /* Space before action icons */
    overflow: hidden;
}

.left-sidebar {
    position: fixed;
    top: 0;
    left: 0;
    height: 100vh; 
    width: 280px; 
    transform: translateX(-100%);
    z-index: 10010; 
    flex-basis: auto; 
    border-right: 1px solid var(--color-border-sidebar); 
    box-shadow: 2px 0 8px rgba(0,0,0,0.15); 
}

body.mobile-sidebar-open .left-sidebar {
    transform: translateX(0);
}

/* Header Actions - container for search, toc-toggle, theme, github */
.header-actions {
    flex-grow: 0; /* Don't let it grow, size by content */
    flex-shrink: 0; /* Don't let it shrink */
    margin-left: auto; /* Push action group to the right */
    gap: 0.25rem; /* Gap between items: search, toc-toggle, theme/github group */
    justify-content: flex-end; /* This was for desktop, override for mobile if needed */
}

.header-actions-right { /* Contains theme, github, and DESKTOP nav links */
    gap: 0; /* Was 0.25rem, but theme/github are hidden */
}

.header-actions-right > .header-nav-link, 
.header-actions-right > .header-dropdown-container { 
    display: none;
}

/* Search trigger adjustments */
#searchTrigger .search-trigger-text,
#searchTrigger .search-shortcut-hint {
    display: none; 
}
#themeToggle,
#githubLink {
    display: none !important;
}
/* Ensure separators for theme toggle are also hidden */
#themeToggle.theme-toggle-button::before,
#themeToggle.theme-toggle-button::after {
    display: none;
}

#searchTrigger {
    padding: 0.4rem; 
    border-color: transparent; 
    margin-right: 0; /* Rely on parent gap */
}
 #searchTrigger .search-trigger-icon-svg {
    margin-right: 0;
}
#searchTrigger:hover {
    border-color: var(--color-search-border); 
    background-color: var(--color-search-trigger-hover-bg); 
}

/* Mobile ToC Toggle Button */
.mobile-toc-toggle {
    display: inline-flex; /* Show ToC toggle on mobile */
    /* Inherits .icon-button styles (padding, border-radius etc) */
    /* color, hover color are from .icon-button */
}
.mobile-toc-toggle svg {
    width: 22px; /* Slightly adjust if needed */
    height: 22px;
}

/* Mobile ToC Panel */
#toc-container {
    position: fixed;
    top: 0;
    right: -280px; /* Start off-screen */
    width: 280px; /* Or your preferred width */
    height: 100vh;
    background-color: var(--color-bg-sidebar);
    z-index: 10008; /* Below main sidebar, above overlay if both open (but one closes other) */
    padding: 1.25rem 1rem; /* Consistent padding */
    box-shadow: -2px 0 8px rgba(0,0,0,0.15);
    transition: transform 0.3s ease-in-out;
    flex-basis: auto; /* Override desktop flex-basis */
    overflow-y: auto; /* Enable scrolling for ToC content */
    /* Desktop sticky/height/top/right properties are overridden here */
    /* scrollbar styling already applied globally to #toc-container */
}
body.mobile-toc-open #toc-container {
    transform: translateX(-100%); /* Slide in from right */
}
/* Ensure ToC links are visible and styled appropriately in the mobile panel */
#toc-container #toc-links a {
    /* Adjust if needed, but existing styles might be fine */
    font-size: 0.9rem;
}


/* Main content adjustments */
.content-toc-row {
    flex-direction: column; 
}
/* #toc-container is handled above for mobile panel, no longer display:none here */

#content-area {
    flex-basis: auto; 
    padding: 1.25rem; 
}
 #content-area h2 {
    padding-top: calc(4rem + 1rem); 
}


/* Footer nav boxes */
.page-navigation-boxes {
    flex-direction: column;
    gap: 0.75rem;
}
.nav-box {
    text-align: left !important; 
}
.next-page-box .nav-box-label,
.next-page-box .nav-box-link,
.previous-page-box .nav-box-label,
.previous-page-box .nav-box-link {
    text-align: left !important;
}
}

@media (max-width: 480px) { /* Smaller phone adjustments */
.app-header {
    padding: 0 0.5rem;
}
.mobile-menu-button {
    margin-right: 0.25rem; /* Tighter space */
}
.mobile-header-logo {
    /* flex-grow: 1; by default from 992px */
    justify-content: center; /* Center logo text if it's short */
    margin: 0 0.25rem; /* Tighter space */
}

.header-actions {
    gap: 0.1rem; /* Tighter gap between search, toc, theme/github */
}
#searchTrigger, .mobile-toc-toggle, .theme-toggle-button, a.icon-button {
    padding: 0.3rem; 
}
.icon-button svg, .theme-toggle-button svg, #searchTrigger svg, .mobile-toc-toggle svg {
    width: 20px;
    height: 20px;
}
#themeToggle.theme-toggle-button::before,
#themeToggle.theme-toggle-button::after {
    display: none; 
}
.header-actions-right { /* contains theme/github */
    gap: 0.05rem; /* very tight */
}

#content-area {
    padding: 1rem;
}
#content-area h1 {
    font-size: 1.75rem;
}
#content-area h2 {
    font-size: 1.4rem;
    padding-top: calc(4rem + 0.5rem); 
}
 .page-meta-row .last-updated-text {
    font-size: 0.8rem; 
}
}

.sidebar-link.active {
    color: var(--color-sidebar-link-text-active);
    font-weight: 600;
}
</style>
</head>

<body>
    <div class="left-sidebar" id="leftSidebar"> <!-- Added ID for aria-controls -->
        <div class="sidebar-brand">
            <a href="#" class="sidebar-logo-link">
                Logo
            </a>
        </div>
        <hr class="sidebar-divider logo-divider">
        <nav class="sidebar-nav">
            <div class="sidebar-nav-section is-open">
                <button class="sidebar-section-toggle" aria-expanded="true" aria-controls="section-content-reference">
                    <span>Reference</span>
                    <svg class="sidebar-section-arrow" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
                </button>
                <div class="sidebar-section-content" id="section-content-reference">
                    <ul class="sidebar-nav-links">
                        <li><a href="#site-config" class="sidebar-link active">Site Config</a></li>
                        <li><a href="#frontmatter-config" class="sidebar-link">Frontmatter Config</a></li>
                    </ul>
                </div>
            </div>
            <hr class="sidebar-divider section-divider">
            <div class="sidebar-nav-section is-open">
                <button class="sidebar-section-toggle" aria-expanded="true" aria-controls="section-content-theme">
                    <span>Default Theme</span>
                    <svg class="sidebar-section-arrow" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
                </button>
                <div class="sidebar-section-content" id="section-content-theme">
                    <ul class="sidebar-nav-links">
                        <li><a href="#theme-overview" class="sidebar-link">Overview</a></li>
                        <li><a href="#theme-nav" class="sidebar-link">Nav</a></li>
                    </ul>
                </div>
            </div>
        </nav>
    </div>
<div class="main-area-wrapper">
    <div class="app-header">
        <button class="mobile-menu-button" id="mobileMenuToggle" aria-label="Open navigation menu" aria-expanded="false" aria-controls="leftSidebar">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="3" y1="12" x2="21" y2="12"></line>
                <line x1="3" y1="6" x2="21" y2="6"></line>
                <line x1="3" y1="18" x2="21" y2="18"></line>
            </svg>
        </button>

        <div class="mobile-header-logo">
            <a href="#" class="sidebar-logo-link">
                Logo
            </a>
        </div>
    
        <div class="header-actions">
            <button id="searchTrigger" class="search-trigger-button" aria-label="Open search (Press /)">
                <svg class="search-trigger-icon-svg" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="11" cy="11" r="8"></circle>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                </svg>
                <span class="search-trigger-text">Search</span>
            </button>
            
            <!-- NEW Mobile ToC Toggle Button -->
            <button class="icon-button mobile-toc-toggle" id="mobileTocToggle" aria-label="Open Table of Contents" aria-expanded="false" aria-controls="toc-container">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="8" y1="6" x2="21" y2="6"></line>
                    <line x1="8" y1="12" x2="21" y2="12"></line>
                    <line x1="8" y1="18" x2="21" y2="18"></line>
                    <line x1="3" y1="6" x2="3.01" y2="6"></line>
                    <line x1="3" y1="12" x2="3.01" y2="12"></line>
                    <line x1="3" y1="18" x2="3.01" y2="18"></line>
                </svg>
            </button>

            <div class="header-actions-right">
                <a href="#guide" class="header-nav-link">Guide</a>
                <a href="#reference" class="header-nav-link">Reference</a>

                <div class="header-dropdown-container" id="versionDropdownContainer">
                    <button class="header-dropdown-trigger" id="versionDropdownTrigger" aria-haspopup="true" aria-expanded="false" aria-controls="versionDropdownMenu">
                        <span>2.0.0-alpha.5</span>
                        <svg class="dropdown-arrow-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline>></svg>
                    </button>
                    <div class="header-dropdown-menu" id="versionDropdownMenu" role="menu" aria-labelledby="versionDropdownTrigger">
                        <a href="#" role="menuitem" class="header-dropdown-item">
                            <span>Changelog</span>
                            <svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>
                        </a>
                        <a href="#" role="menuitem" class="header-dropdown-item">
                            <span>Changelog</span>
                            <svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>
                        </a>
                    </div>
                </div>

                <button id="themeToggle" class="theme-toggle-button" aria-label="Toggle theme">
                    <span class="theme-icon theme-icon-sun">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M12 17q-2.075 0-3.537-1.463T7 12t1.463-3.537T12 7t3.538 1.463T17 12t-1.463 3.538T12 17m-7-4H1v-2h4zm18 0h-4v-2h4zM11 5V1h2v4zm0 18v-4h2v4zM6.4 7.75L3.875 5.325L5.3 3.85l2.4 2.5zm12.3 12.4l-2.425-2.525L17.6 16.25l2.525 2.425zM16.25 6.4l2.425-2.525L20.15 5.3l-2.5 2.4zM3.85 18.7l2.525-2.425L7.75 17.6l-2.425 2.525z"/></svg>
                    </span>
                    <span class="theme-icon theme-icon-moon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M12 21q-3.75 0-6.375-2.625T3 12t2.625-6.375T12 3q.35 0 .688.025t.662.075q-1.025.725-1.638 1.888T11.1 7.5q0 2.25 1.575 3.825T16.5 12.9q1.375 0 2.525-.613T20.9 10.65q.05.325.075.662T21 12q0 3.75-2.625 6.375T12 21"/></svg>
                    </span>
                </button>

                <a href="YOUR_GITHUB_REPO_LINK_HERE" target="_blank" rel="noopener noreferrer" id="githubLink" class="icon-button" aria-label="View source on GitHub">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg>
                </a>
            </div>
        </div>
    </div>

    <div class="content-toc-row">
        <div id="content-area" tabindex="0">

            <h1>MOM</h1>
            <P>On this page</P>
            <h2 id="introduction">Introduction</h2>
            <p>Welcome to this comprehensive guide. This section provides an overview of the entire document, its purpose, and what you can expect to learn. We will cover various topics in detail, ensuring a clear understanding for all readers.</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
            <p>Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
            <h2 id="getting-started">Getting Started</h2>
            <p>This section will walk you through the initial setup and prerequisites. Before diving into the core features, it's important to have your environment configured correctly. We'll cover software installation and basic configuration steps.</p>
            <h2 id="core-concepts">Core Concepts</h2>
            <p>Understanding the core concepts is crucial for effective use. This part delves into the fundamental principles and ideas that underpin the system. We will explore definitions, key terminologies, and their relationships.</p>
            <h2 id="feature-alpha">Feature Alpha</h2>
            <p>Feature Alpha provides capabilities for X, Y, and Z. It is designed to enhance productivity and streamline workflows related to data processing. This section explains its architecture and benefits.</p>
            <h2 id="feature-beta">Feature Beta</h2>
            <p>Building upon Alpha, Feature Beta introduces advanced functionalities. It focuses on scalability and integration with other services. Here, we will cover its advanced configuration options and use cases.</p>
            <h2 id="advanced-configuration">Advanced Configuration</h2>
            <p>For users requiring more control, the advanced configuration options offer granular adjustments. This section is for experienced users who need to tailor the system to specific, complex requirements.</p>
            <h2 id="api-reference">API Reference</h2>
            <p>The API Reference provides detailed documentation for all available endpoints and methods. Developers can use this information to integrate the system with other applications or build custom tools.</p>
            <h2 id="troubleshooting">Troubleshooting</h2>
            <p>Encountering issues? This section lists common problems and their solutions. It also provides guidance on how to diagnose and report new issues effectively. Please consult this section before seeking further support.</p>
            <h2 id="security-guidelines">Security Guidelines</h2>
            <p>Security is paramount. These guidelines outline best practices for securing your installation and data. It covers aspects like access control, data encryption, and regular security audits.</p>
            <h2 id="performance-tuning">Performance Tuning</h2>
            <p>Learn how to optimize performance for various workloads. This section covers techniques for identifying bottlenecks and applying configurations to improve speed and efficiency.</p>
            <h2 id="backup-restore">Backup and Restore</h2>
            <p>Data integrity is crucial. This section details procedures for backing up your data and restoring it in case of system failure or data loss. Regular backups are highly recommended.</p>
            <h2 id="migration-guide">Migration Guide</h2>
            <p>Upgrading from a previous version? This guide provides step-by-step instructions for migrating your existing data and configurations to the latest version smoothly.</p>
            <h2 id="contributing">Contributing</h2>
            <p>Interested in contributing to the project? This section outlines how you can get involved, from reporting bugs and suggesting features to submitting code contributions. Your help is appreciated!</p>
            <h2 id="license-information">License Information</h2>
            <p>This software is distributed under the XYZ License. This section provides the full text of the license and details about any third-party components and their respective licenses.</p>
            <h2 id="appendix-a">Appendix A: Glossary</h2>
            <p>A list of terms and definitions used throughout this documentation. This can be a helpful reference for understanding specific jargon or technical terms.</p>
            <h2 id="appendix-b">Appendix B: Further Reading</h2>
            <p>For those who wish to explore related topics further, this appendix lists recommended books, articles, and online resources. These can provide deeper insights or alternative perspectives.</p>
            <h2 id="section-example-1">Example Section 1</h2>
            <p>Placeholder content for example section 1 to ensure it's a target.</p>
            <h2 id="section-example-2">Example Section 2</h2>
            <p>Placeholder content for example section 2.</p>
            <h2 id="section-example-3">Example Section 3</h2>
            <p>Placeholder content for example section 3.</p>
            <h2 id="section-example-4">Example Section 4</h2>
            <p>Placeholder content for example section 4.</p>
            <h2 id="section-example-5">Example Section 5</h2>
            <p>Placeholder content for example section 5. This is the very last piece of main content.</p>

            <div class="page-footer-container">
                <div class="page-meta-row">
                    <a href="#" class="edit-page-link">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83l3.75 3.75l1.83-1.83z"/>
                    </svg>Edit this page on GitHub
                    </a>
                    <span class="last-updated-text">Last updated: 1/7/25, 2:24 AM</span>
                </div>
                <hr class="footer-divider-line">
                <div class="page-navigation-boxes">
                    <div class="nav-box previous-page-box">
                    <span class="nav-box-label">Previous page</span>
                    <a href="#" class="nav-box-link">What is VitePress?</a>
                    </div>
                    <div class="nav-box next-page-box">
                    <span class="nav-box-label">Next page</span>
                    <a href="#" class="nav-box-link">Routing</a>
                    </div>
                </div>
            </div>
        </div>
    <div id="toc-container"> <!-- This container is now also the mobile ToC panel -->
        <p class="toc-container-header">On This Page</p>
        <nav id="toc-links">
            <div id="toc-active-marker"></div>
            <a href="#introduction">Introduction</a> 
            <a href="#getting-started">Getting Started</a>
            <a href="#core-concepts">Core Concepts</a>
            <a href="#feature-alpha">Feature Alpha</a>
            <a href="#feature-beta">Feature Beta</a>
            <a href="#advanced-configuration">Advanced Configuration</a>
            <a href="#api-reference">API Reference</a>
            <a href="#troubleshooting">Troubleshooting</a>
            <a href="#security-guidelines">Security Guidelines</a>
            <a href="#performance-tuning">Performance Tuning</a>
            <a href="#backup-restore">Backup and Restore</a>
            <a href="#migration-guide">Migration Guide</a>
            <a href="#contributing">Contributing</a>
            <a href="#license-information">License Information</a> 
            <a href="#appendix-a">Appendix A: Glossary</a>
            <a href="#appendix-b">Appendix B: Further Reading</a>
            <a href="#section-example-1">Example Section 1</a>
            <a href="#section-example-2">Example Section 2</a>
            <a href="#section-example-3">Example Section 3</a>
            <a href="#section-example-4">Example Section 4</a>
            <a href="#section-example-5">Example Section 5</a>
        </nav>
    </div>
        </div>
</div>

<div class="page-overlay" id="pageOverlay"></div>

 <script>
document.addEventListener('DOMContentLoaded', () => {
    // --- Element References ---
    const htmlElement = document.documentElement;
    const mainScroller = document.querySelector('.main-area-wrapper');
    const themeToggleButton = document.getElementById('themeToggle');
    const tocContainerElement = document.getElementById('toc-container');
    const tocLinksContainer = document.getElementById('toc-links');
    const tocActiveMarker = document.getElementById('toc-active-marker');
    let tocLinks = tocLinksContainer ? Array.from(tocLinksContainer.getElementsByTagName('a')) : [];
    const searchTriggerButton = document.getElementById('searchTrigger');
    const searchOverlayEl = document.getElementById('searchOverlay');
    const searchInput = document.getElementById('searchInput');
    const searchCloseButton = document.getElementById('searchCloseButton');
    const mobileMenuToggle = document.getElementById('mobileMenuToggle');
    const leftSidebar = document.getElementById('leftSidebar'); // Used ID
    const pageOverlay = document.getElementById('pageOverlay');
    const mobileTocToggle = document.getElementById('mobileTocToggle'); // New ToC toggle

    // --- State Variables ---
    const THEME_KEY = 'user-preferred-theme';
    const sections = {};
    const scrollOffset = 20; // For scroll spy
    let isSearchActive = false;

    // --- Helper: Update Body Scroll & Page Overlay ---
    function updateBodyScrollAndOverlay() {
        const isSidebarOpen = document.body.classList.contains('mobile-sidebar-open');
        const isTocOpen = document.body.classList.contains('mobile-toc-open');
        const transitionDuration = 300; // ms, should match CSS transition for opacity

        if (isSidebarOpen || isTocOpen) {
            if (pageOverlay.style.display !== 'block') {
                pageOverlay.style.display = 'block';
                requestAnimationFrame(() => { pageOverlay.style.opacity = '1'; });
            }
            document.body.style.overflow = 'hidden';
        } else {
            pageOverlay.style.opacity = '0';
            setTimeout(() => {
                if (!document.body.classList.contains('mobile-sidebar-open') &&
                    !document.body.classList.contains('mobile-toc-open')) {
                    pageOverlay.style.display = 'none';
                }
            }, transitionDuration);
            document.body.style.overflow = '';
        }
    }

    // --- 1. Theme Functionality ---
    function applyTheme(theme) {
        htmlElement.classList.toggle('light-theme', theme === 'light');
        htmlElement.classList.toggle('dark-theme', theme === 'dark');
        if (themeToggleButton) themeToggleButton.setAttribute('aria-label', theme === 'light' ? 'Switch to Dark Theme' : 'Switch to Light Theme');
    }
    function saveThemePreference(theme) { localStorage.setItem(THEME_KEY, theme); }
    function getInitialTheme() {
        const savedTheme = localStorage.getItem(THEME_KEY);
        if (savedTheme) return savedTheme;
        return window.matchMedia?.('(prefers-color-scheme: light)').matches ? 'light' : 'dark';
    }
    if (themeToggleButton) {
        themeToggleButton.addEventListener('click', () => {
            const newTheme = htmlElement.classList.contains('light-theme') ? 'dark' : 'light';
            applyTheme(newTheme);
            saveThemePreference(newTheme);
        });
    }
    applyTheme(getInitialTheme());

    // --- 2. Table of Contents (Scroll Spy & Active Marker) ---
    if (tocLinks.length > 0) {
        tocLinks.forEach(link => {
            const href = link.getAttribute('href');
            if (href?.startsWith('#')) {
                const sectionElement = document.getElementById(href.substring(1));
                if (sectionElement) sections[href.substring(1)] = sectionElement;
            }
        });
    }
    function updateActiveLinkAndMarker() {
        if (!mainScroller || tocLinks.length === 0 || !tocActiveMarker) return;
        let currentSectionId = null;
        const contentScrollTop = mainScroller.scrollTop;
        const sectionIds = Object.keys(sections);

        for (let i = sectionIds.length - 1; i >= 0; i--) {
            const id = sectionIds[i];
            if (sections[id] && (sections[id].offsetTop - scrollOffset <= contentScrollTop)) {
                currentSectionId = id; break;
            }
        }
        if (currentSectionId === null && sectionIds.length > 0 && sections[sectionIds[0]] &&
            (contentScrollTop < scrollOffset || contentScrollTop < (sections[sectionIds[0]].offsetTop - scrollOffset))) {
            currentSectionId = sectionIds[0];
        }
        // Check if scrolled to the very bottom
        if (sectionIds.length > 0 && (mainScroller.scrollHeight - mainScroller.scrollTop <= mainScroller.clientHeight + 5)) { // +5 for small buffer
            currentSectionId = sectionIds[sectionIds.length - 1];
        }

        let activeLinkElement = null;
        tocLinks.forEach(link => {
            link.classList.remove('active');
            if (link.getAttribute('href') === `#${currentSectionId}`) {
                link.classList.add('active'); activeLinkElement = link;
            }
        });

        if (activeLinkElement && tocContainerElement && tocContainerElement.scrollHeight > tocContainerElement.clientHeight) {
            const linkTopInToc = activeLinkElement.offsetTop;
            const linkHeight = activeLinkElement.offsetHeight; // Still useful for scroll logic
            const linkBottomInToc = linkTopInToc + linkHeight;
            const tocScrollTop = tocContainerElement.scrollTop;
            const tocClientHeight = tocContainerElement.clientHeight;
            const scrollPadding = 30;
            if (linkTopInToc < tocScrollTop + scrollPadding) {
                tocContainerElement.scrollTo({ top: Math.max(0, linkTopInToc - scrollPadding), behavior: 'smooth' });
            } else if (linkBottomInToc > tocScrollTop + tocClientHeight - scrollPadding) {
                tocContainerElement.scrollTo({ top: Math.min(linkBottomInToc - tocClientHeight + scrollPadding, tocContainerElement.scrollHeight - tocClientHeight), behavior: 'smooth' });
            }
        }

        // UPDATED PART for marker height and top:
        if (activeLinkElement) {
            const markerTop = activeLinkElement.offsetTop; // offsetTop is integer, relative to #toc-links
            const linkRect = activeLinkElement.getBoundingClientRect(); // Get precise fractional dimensions

            tocActiveMarker.style.top = `${markerTop}px`;
            tocActiveMarker.style.height = `${linkRect.height}px`; // Use precise fractional height
            tocActiveMarker.style.opacity = '1';
        } else {
            tocActiveMarker.style.opacity = '0';
        }
    }
    if (tocLinksContainer) {
        tocLinksContainer.addEventListener('click', (e) => {
            const target = e.target.closest('a');
            if (target?.getAttribute('href')?.startsWith('#')) {
                e.preventDefault();
                const targetElement = document.getElementById(target.getAttribute('href').substring(1));
                if (targetElement && mainScroller) mainScroller.scrollTo({ top: targetElement.offsetTop, behavior: 'smooth' });
                // If mobile ToC is open, close it
                if (document.body.classList.contains('mobile-toc-open')) {
                    closeMobileToc();
                }
            }
        });
    }
    if (mainScroller && tocLinks.length > 0) {
        mainScroller.addEventListener('scroll', updateActiveLinkAndMarker);
        updateActiveLinkAndMarker(); // Initial call
    }

    // --- 3. Search Functionality ---
    function isEditingContent(element) {
        const tagName = element?.tagName;
        return tagName === 'INPUT' || tagName === 'TEXTAREA' || element?.isContentEditable || element?.closest('input, textarea, [contenteditable="true"], [contenteditable=""]');
    }
    function openSearch() {
        if (isSearchActive || !searchOverlayEl || !searchInput) return;
        requestAnimationFrame(() => {
            searchOverlayEl.classList.add('active');
            setTimeout(() => { searchInput.value = ''; searchInput.focus(); }, 60);
        });
        document.body.style.overflow = 'hidden'; // Search also locks scroll
        isSearchActive = true;
    }
    function closeSearch() {
        if (!isSearchActive || !searchOverlayEl) return;
        searchOverlayEl.classList.remove('active');
        if(searchInput) searchInput.blur();
        if (searchTriggerButton) searchTriggerButton.focus({ preventScroll: true });
        isSearchActive = false;
        if (!document.body.classList.contains('mobile-sidebar-open') && !document.body.classList.contains('mobile-toc-open')) {
            document.body.style.overflow = ''; // Restore scroll if no other panel is open
        }
    }
    if (searchTriggerButton) searchTriggerButton.addEventListener('click', openSearch);
    if (searchCloseButton) searchCloseButton.addEventListener('click', closeSearch);
    if (searchOverlayEl) searchOverlayEl.addEventListener('click', (e) => { if (e.target === searchOverlayEl) closeSearch(); });

    // --- 4. Sidebar Accordion ---
    document.querySelectorAll('.sidebar-nav .sidebar-nav-section').forEach(section => {
        const toggleButton = section.querySelector('.sidebar-section-toggle');
        const content = section.querySelector('.sidebar-section-content');
        if (toggleButton && content) {
            if (section.classList.contains('is-open')) {
                const originalTransition = content.style.transition;
                content.style.transition = 'none'; // Disable transition for initial open
                content.style.maxHeight = content.scrollHeight + "px";
                requestAnimationFrame(() => { // Force reflow
                    requestAnimationFrame(() => { content.style.transition = originalTransition; }); // Restore transition
                });
            }
            toggleButton.addEventListener('click', () => {
                const isOpen = section.classList.toggle('is-open');
                toggleButton.setAttribute('aria-expanded', isOpen.toString());
                content.style.maxHeight = isOpen ? content.scrollHeight + "px" : "0px";
            });
        }
    });

    // --- 5. Mobile Navigation (Main Sidebar) ---
    function openMobileSidebar() {
        if (!leftSidebar || !mobileMenuToggle) return;
        if (document.body.classList.contains('mobile-toc-open')) closeMobileToc(); // Close ToC if open
        document.body.classList.add('mobile-sidebar-open');
        mobileMenuToggle.setAttribute('aria-expanded', 'true');
        leftSidebar.querySelector('.sidebar-nav')?.scrollTo(0, 0);
        updateBodyScrollAndOverlay();
    }
    function closeMobileSidebar() {
        if (!leftSidebar || !mobileMenuToggle) return;
        document.body.classList.remove('mobile-sidebar-open');
        mobileMenuToggle.setAttribute('aria-expanded', 'false');
        updateBodyScrollAndOverlay();
    }
    if (mobileMenuToggle && leftSidebar) {
        mobileMenuToggle.addEventListener('click', () => {
            document.body.classList.contains('mobile-sidebar-open') ? closeMobileSidebar() : openMobileSidebar();
        });
    }
    if (leftSidebar) {
        leftSidebar.addEventListener('click', (event) => {
            if (event.target.closest('a') && document.body.classList.contains('mobile-sidebar-open')) {
                closeMobileSidebar();
            }
        });
    }

    // --- 6. Mobile Table of Contents Panel ---
    function openMobileToc() {
        if (!tocContainerElement || !mobileTocToggle) return;
        if (document.body.classList.contains('mobile-sidebar-open')) closeMobileSidebar(); // Close main sidebar if open
        document.body.classList.add('mobile-toc-open');
        mobileTocToggle.setAttribute('aria-expanded', 'true');
        tocContainerElement.scrollTo(0, 0); // Scroll to top of ToC panel
        updateActiveLinkAndMarker(); // Ensure active marker is correct on open
        updateBodyScrollAndOverlay();
    }
    function closeMobileToc() {
        if (!tocContainerElement || !mobileTocToggle) return;
        document.body.classList.remove('mobile-toc-open');
        mobileTocToggle.setAttribute('aria-expanded', 'false');
        updateBodyScrollAndOverlay();
    }
    if (mobileTocToggle && tocContainerElement) {
        mobileTocToggle.addEventListener('click', () => {
            document.body.classList.contains('mobile-toc-open') ? closeMobileToc() : openMobileToc();
        });
    }
    // Note: ToC link clicks are handled in section 2 to close the panel.

    // --- 7. Global Event Listeners (Overlay, Keyboard) ---
    if (pageOverlay) {
        pageOverlay.addEventListener('click', () => {
            if (document.body.classList.contains('mobile-sidebar-open')) closeMobileSidebar();
            if (document.body.classList.contains('mobile-toc-open')) closeMobileToc();
        });
    }
    document.addEventListener('keydown', (e) => {
        if (e.key === '/' && !isSearchActive && !isEditingContent(document.activeElement)) { e.preventDefault(); openSearch(); }
        if (e.key === 'k' && (e.ctrlKey || e.metaKey)) { e.preventDefault(); isSearchActive ? closeSearch() : openSearch(); }
        if (e.key === 'Escape') {
            if (isSearchActive) { e.preventDefault(); closeSearch(); }
            else if (document.body.classList.contains('mobile-sidebar-open')) { e.preventDefault(); closeMobileSidebar(); }
            else if (document.body.classList.contains('mobile-toc-open')) { e.preventDefault(); closeMobileToc(); }
        }
    });
});
</script><!-- Search Modal Overlay -->
<div id="searchOverlay" class="search-overlay"> 
    <div id="searchModal" class="search-modal" role="dialog" aria-modal="true" aria-labelledby="searchModalTitle">
    <div class="search-input-container">
        <svg class="search-modal-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="11" cy="11" r="8"></circle>
        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
        </svg>
        <input type="text" id="searchInput" class="search-input" placeholder="Search documentation..." aria-label="Search input">
        <button id="searchCloseButton" class="search-close-button" aria-label="Close search">
        </button>
    </div>
    <div id="searchResultsContainer" class="search-results-container">
        <p class="search-results-placeholder">Start typing to see results.</p>
    </div>
    </div>
</div>
</body>
</html>