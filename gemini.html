<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ModernDocs - Your Project</title>
    <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>
    <style>
        /* CSS Variables for Theming and Layout */
        :root {
            --font-sans: 'Segoe UI', -apple-system, BlinkMacSystemFont, 'Helvetica Neue', Arial, sans-serif;
            --font-mono: 'Consolas', 'Monaco', 'Courier New', Courier, monospace;

            /* Light Theme (Default) */
            --bg-color: #ffffff;
            --text-color: #212529;
            --header-bg: #ffffff;
            --sidebar-bg: #f8f9fa;
            --accent-color: #007bff;
            --accent-hover: #0056b3;
            --border-color: #dee2e6;
            --code-bg: #f1f3f5;
            --code-text: #212529;
            --link-color: #007bff;
            --toc-link-color: #495057;
            --scrollbar-thumb: #adb5bd;
            --scrollbar-track: #e9ecef;
            --shadow-color: rgba(0, 0, 0, 0.075);
            --active-nav-link-bg: #e0eafc;
            --header-nav-text-color: #495057;
            --search-bg: #f1f3f5;
            --search-text: #6c757d;
            --search-border: #ced4da;

            /* Material Design Dark Theme Inspired Base Variables (values for dark theme are in .dark-theme) */
            --md-dark-surface-00dp: #121212;
            --md-dark-surface-01dp: #1D1D1D;
            --md-dark-surface-02dp: #222222;
            --md-dark-surface-03dp: #252525;
            --md-dark-surface-04dp: #272727;
            --md-dark-surface-06dp: #2C2C2C;
            --md-dark-surface-08dp: #2E2E2E;
            --md-dark-surface-12dp: #323232;
            --md-dark-on-surface-high-emphasis: rgba(255, 255, 255, 0.87);
            --md-dark-on-surface-medium-emphasis: rgba(255, 255, 255, 0.60);
            --md-dark-on-surface-disabled: rgba(255, 255, 255, 0.38);
            --md-dark-primary-accent: #79b8ff;
            --md-dark-primary-accent-hover: #9acbff;
        }

        .dark-theme {
            --bg-color: var(--md-dark-surface-00dp);
            --text-color: var(--md-dark-on-surface-high-emphasis);
            --header-bg: var(--md-dark-surface-04dp);
            --sidebar-bg: var(--md-dark-surface-01dp);
            --accent-color: var(--md-dark-primary-accent);
            --accent-hover: var(--md-dark-primary-accent-hover);
            --border-color: rgba(255, 255, 255, 0.12);
            --code-bg: var(--md-dark-surface-01dp);
            --code-text: var(--md-dark-on-surface-high-emphasis);
            --link-color: var(--md-dark-primary-accent);
            --toc-link-color: var(--md-dark-on-surface-medium-emphasis);
            --scrollbar-thumb: #4A4A4A;
            --scrollbar-track: var(--md-dark-surface-02dp);
            --shadow-color: rgba(0, 0, 0, 0.3);
            --active-nav-link-bg: rgba(255, 255, 255, 0.08);
            --header-nav-text-color: var(--md-dark-on-surface-medium-emphasis);
            --search-bg: var(--md-dark-surface-03dp);
            --search-text: var(--md-dark-on-surface-medium-emphasis);
            --search-border: transparent;
        }

        /* Global Resets and Base Styles */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        body {
            font-family: var(--font-sans);
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.7; font-size: 15px;
            transition: background-color 0.2s ease, color 0.2s ease;
            display: flex; flex-direction: column; min-height: 100vh;
        }

        /* Scrollbar Styling */
        ::-webkit-scrollbar { width: 7px; height: 7px; }
        ::-webkit-scrollbar-track { background: var(--scrollbar-track); border-radius: 10px; }
        ::-webkit-scrollbar-thumb { background: var(--scrollbar-thumb); border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--accent-color); }

        /* Header */
        .site-header {
            background-color: var(--header-bg); padding: 0 24px; height: 64px;
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid var(--border-color);
            position: sticky; top: 0; z-index: 1000;
            transition: background-color 0.2s ease, border-color 0.2s ease;
        }
        .header-left { display: flex; align-items: center; gap: 12px; }
        .logo-container {
            display: flex; align-items: center; gap: 8px;
            font-size: 1.25em; font-weight: 600; color: var(--accent-color);
        }
        .logo-container iconify-icon { font-size: 1.5em; }

        .header-center { display: flex; align-items: center; gap: 20px; flex-grow: 1; padding-left: 40px;}
        .search-container {
            display: flex; align-items: center;
            background-color: var(--search-bg);
            border: 1px solid var(--search-border);
            border-radius: 6px; padding: 6px 10px; width: 240px;
            transition: background-color 0.2s, border-color 0.2s ease-out;
        }
        .dark-theme .search-container { border-color: var(--search-border); } /* Ensure it uses the variable */

        .search-container.search-container--focused {
            border-color: var(--accent-color) !important; /* Ensure focus border overrides dark theme transparent if any */
        }
        .search-container .search-icon {
            font-size: 1.1em; color: var(--search-text); margin-right: 8px;
            transition: transform 0.2s ease-out, color 0.2s ease-out;
        }
        .search-container.search-container--focused .search-icon {
            transform: scale(1.1) translateX(-2px);
            color: var(--accent-color);
        }
        #search-input {
            background: none; background-color: transparent;
            border: none; outline: none;
            color: var(--text-color); font-size: 0.9em; width: 100%;
            padding: 0; line-height: normal;
        }
        #search-input::placeholder { color: var(--search-text); opacity: 1;}

        .header-nav { display: flex; gap: 20px; }
        .header-nav a {
            text-decoration: none; color: var(--header-nav-text-color);
            font-weight: 500; font-size: 0.9em; transition: color 0.2s;
        }
        .header-nav a:hover { color: var(--accent-color); }

        .header-right { display: flex; align-items: center; gap: 12px; }
        .theme-toggle-btn, .social-link {
            background: none; border: none; cursor: pointer;
            font-size: 1.3em; color: var(--header-nav-text-color);
            padding: 6px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            transition: color 0.2s ease, transform 0.2s ease;
        }
        .theme-toggle-btn:hover, .social-link:hover { color: var(--accent-color); }

        /* Main Container */
        .main-container { display: flex; flex-grow: 1; }

        /* Left Sidebar */
        .left-sidebar {
            width: 260px; background-color: var(--sidebar-bg);
            padding: 16px 0; border-right: 1px solid var(--border-color);
            height: calc(100vh - 64px); overflow-y: auto;
            position: sticky; top: 64px;
            transition: background-color 0.2s ease, border-color 0.2s ease;
        }
        .accordion-item { margin-bottom: 4px; }
        .accordion-item .accordion-header {
            background-color: transparent; color: var(--text-color); cursor: pointer;
            padding: 8px 20px; width: 100%; text-align: left;
            border: none; outline: none; font-size: 0.95em; font-weight: 600;
            transition: background-color 0.1s ease, color 0.1s ease;
            display: flex; justify-content: space-between; align-items: center;
        }
        .accordion-item .accordion-header:hover { background-color: var(--active-nav-link-bg); }
        .accordion-item .arrow { font-size: 1.1em; line-height: 1; color: var(--toc-link-color); }
        .accordion-item .accordion-header:hover .arrow,
        .accordion-item .accordion-header.active-accordion-header .arrow { color: var(--text-color); }
        .accordion-content {
            max-height: 0; overflow: hidden;
            transition: max-height 0.25s ease-out;
        }
        .accordion-content ul { list-style: none; padding-left: 0; }
        .accordion-content ul li a {
            display: block; padding: 7px 20px 7px 32px;
            text-decoration: none; color: var(--text-color);
            transition: color 0.1s ease, background-color 0.1s ease, border-color 0.1s ease;
            font-size: 0.9em; font-weight: 500;
            border-left: 2px solid transparent; /* Changed to 2px */
        }
        .accordion-content ul li a:hover { color: var(--accent-color); background-color: var(--active-nav-link-bg); }
        .accordion-content ul li a.active-nav-link {
            color: var(--accent-color); font-weight: 600;
            background-color: var(--active-nav-link-bg);
            border-left-color: var(--accent-color);
            padding-left: calc(32px - 2px); /* Adjusted for 2px border */
        }

        /* Main Content Area */
        .main-content {
            flex-grow: 1; padding: 24px 32px;
            background-color: var(--bg-color);
            max-width: calc(100% - 260px - 220px);
            transition: background-color 0.2s ease;
        }
        .main-content article { max-width: 788px; margin: 0 auto; }
        .main-content h1, .main-content h2, .main-content h3 {
            color: var(--text-color); font-weight: 600;
            margin-top: 2em; margin-bottom: 0.8em;
            scroll-margin-top: calc(64px + 16px);
        }
        .main-content h1 { font-size: 2em; border-bottom: 1px solid var(--border-color); padding-bottom: 0.4em; color: var(--accent-color); }
        .dark-theme .main-content h1 { color: var(--accent-color); }
        .main-content h2 { font-size: 1.5em; }
        .main-content h3 { font-size: 1.2em; }
        .main-content p { margin-bottom: 1.1em; }
        .main-content ul, .main-content ol { margin-bottom: 1.1em; padding-left: 25px; }
        .main-content code {
            font-family: var(--font-mono); background-color: var(--code-bg);
            color: var(--accent-color); padding: 0.15em 0.4em;
            border-radius: 4px; font-size: 0.875em;
        }
        .main-content pre {
            background-color: var(--code-bg); color: var(--code-text);
            padding: 16px; border-radius: 6px; overflow-x: auto;
            margin: 1.5em 0; font-size: 0.875em; border: 1px solid var(--border-color);
        }
        .main-content pre code { background-color: transparent; padding: 0; color: inherit; font-size: 1em; }
        .main-content a { color: var(--link-color); text-decoration: none; font-weight: 500; }
        .main-content a:hover { text-decoration: underline; color: var(--accent-hover); }
        .main-content blockquote {
            border-left: 3px solid var(--accent-color); padding-left: 16px;
            margin: 1.5em 0; color: var(--toc-link-color);
        }
        .main-content table { width: 100%; border-collapse: collapse; margin-bottom: 1.5em; font-size: 0.9em; }
        .main-content th, .main-content td { border: 1px solid var(--border-color); padding: 10px 12px; text-align: left; }
        .main-content th { background-color: var(--sidebar-bg); font-weight: 600; color: var(--text-color); }

        /* Right Sidebar (Table of Contents) */
        .right-sidebar {
            width: 220px; background-color: var(--bg-color);
            padding: 16px 0 16px 16px;
            height: calc(100vh - 64px); overflow-y: auto;
            position: sticky; top: 64px;
            transition: background-color 0.2s ease;
            font-size: 0.85em;
        }
        .right-sidebar h4 {
            font-size: 0.9em; margin-bottom: 10px;
            color: var(--text-color); font-weight: 600; padding-left: 8px;
        }
        #toc-list { list-style: none; padding: 0; }
        #toc-list li a {
            display: block; padding: 6px 8px;
            text-decoration: none; color: var(--toc-link-color);
            transition: color 0.1s ease, border-color 0.1s ease;
            border-left: 2px solid transparent; line-height: 1.5;
        }
        #toc-list li a:hover { color: var(--accent-color); }
        #toc-list li a.toc-active { color: var(--accent-color); font-weight: 600; border-left-color: var(--accent-color); }
        #toc-list li.toc-h2 a { padding-left: 20px; }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .main-content { max-width: calc(100% - 260px); }
            .right-sidebar { display: none; }
            .header-center { padding-left: 20px; }
            .header-nav { display: none; }
        }
        @media (max-width: 768px) {
            .main-container { flex-direction: column; }
            .left-sidebar { width: 100%; position: static; height: auto; border-right: none; border-bottom: 1px solid var(--border-color); padding-bottom: 0; }
            .main-content { padding: 20px; max-width: 100%; }
            .site-header { padding: 0 16px; height: 56px; }
            .logo-container { font-size: 1.1em; } .logo-container iconify-icon { font-size: 1.3em; }
            .header-center { display: none; }
            .right-sidebar { display: none; }
            .main-content h1 { font-size: 1.8em; scroll-margin-top: calc(56px + 16px);}
            .main-content h2 { font-size: 1.5em; scroll-margin-top: calc(56px + 16px);}
        }
    </style>
</head>
<body>

    <header class="site-header">
        <div class="header-left">
            <div class="logo-container">
                <iconify-icon icon="mdi:book-open-page-variant-outline"></iconify-icon>
                <span>ModernDocs</span>
            </div>
        </div>
        <div class="header-center">
            <div class="search-container" id="search-widget-container">
                <iconify-icon icon="mdi:magnify" class="search-icon"></iconify-icon>
                <input type="text" placeholder="Search Ctrl+K or /" id="search-input" aria-label="Search documentation">
            </div>
            <nav class="header-nav">
                <a href="#">Guide</a>
                <a href="#">Reference</a>
            </nav>
        </div>
        <div class="header-right">
            <button id="theme-toggle" class="theme-toggle-btn" aria-label="Toggle theme">
                <iconify-icon icon="mdi:weather-sunny" id="theme-icon"></iconify-icon>
            </button>
            <a href="https://github.com" target="_blank" rel="noopener noreferrer" class="social-link" aria-label="GitHub Repository">
                <iconify-icon icon="mdi:github"></iconify-icon>
            </a>
        </div>
    </header>

    <div class="main-container">
        <nav class="left-sidebar">
            <div class="accordion">
                <div class="accordion-item">
                    <button class="accordion-header">
                        Getting Started
                        <span class="arrow"><iconify-icon icon="mdi:chevron-right"></iconify-icon></span>
                    </button>
                    <div class="accordion-content">
                        <ul>
                            <li><a href="#introduction" class="nav-link">Introduction</a></li>
                            <li><a href="#installation" class="nav-link">Installation</a></li>
                            <li><a href="#quick-start" class="nav-link">Quick Start</a></li>
                        </ul>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">
                        Core Concepts
                        <span class="arrow"><iconify-icon icon="mdi:chevron-right"></iconify-icon></span>
                    </button>
                    <div class="accordion-content">
                        <ul>
                            <li><a href="#architecture" class="nav-link">Architecture</a></li>
                            <li><a href="#components" class="nav-link">Components</a></li>
                            <li><a href="#state-management" class="nav-link">State Management</a></li>
                        </ul>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">
                        API Reference
                        <span class="arrow"><iconify-icon icon="mdi:chevron-right"></iconify-icon></span>
                    </button>
                    <div class="accordion-content">
                        <ul>
                            <li><a href="#api-overview" class="nav-link">Overview</a></li>
                            <li><a href="#endpoints" class="nav-link">Endpoints</a></li>
                            <li><a href="#authentication" class="nav-link">Authentication</a></li>
                        </ul>
                    </div>
                </div>
                 <div class="accordion-item">
                    <button class="accordion-header">
                        Advanced Topics
                        <span class="arrow"><iconify-icon icon="mdi:chevron-right"></iconify-icon></span>
                    </button>
                    <div class="accordion-content">
                        <ul>
                            <li><a href="#performance" class="nav-link">Performance</a></li>
                            <li><a href="#security" class="nav-link">Security</a></li>
                            <li><a href="#deployment" class="nav-link">Deployment</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </nav>

        <main class="main-content">
            <article>
                <section id="introduction">
                    <h1>Introduction</h1>
                    <p>Welcome to the official documentation for ModernDocs, a fictional project designed to showcase a beautiful and modern documentation website. This document will guide you through its features, setup, and usage.</p>
                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
                    <blockquote> This is an example of a blockquote. It can be used to highlight important information or quotes. </blockquote>
                </section>
                <section id="installation">
                    <h2>Installation</h2>
                    <p>To get started with ModernDocs, you'll first need to ensure you have the necessary prerequisites installed on your system. This typically includes a modern web browser.</p>
                    <p>Follow these steps:</p>
                    <ol>
                        <li>Download the project files (or clone the repository).</li>
                        <li>Open the <code>index.html</code> file in your browser.</li>
                        <li>No server is needed for this example as it's a single HTML file.</li>
                    </ol>
                    <pre><code class="language-bash"> # If it were a real project, you might do:
git clone https://example.com/your-repo.git
cd your-repo
# npm install (if it had dependencies)
# npm start (if it had a dev server) </code></pre>
                </section>
                <section id="quick-start">
                    <h2>Quick Start</h2>
                    <p>This section provides a brief overview to get you up and running quickly.</p>
                    <p>Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                    <h3>Basic Configuration</h3>
                    <p>Configuration options can be found within the JavaScript section if this were a more complex application. For this demo, it's self-contained.</p>
                    <pre><code class="language-javascript"> // Example JavaScript snippet
function greet(name) {
  console.log(`Hello, ${name}! Welcome to ModernDocs.`);
}
greet('Developer'); </code></pre>
                </section>
                <section id="architecture">
                    <h1>Core Concepts</h1>
                    <h2 id="components">Architecture & Components</h2>
                    <p>The architecture of this documentation site is based on a three-column layout: Left Navigation, Main Content, and Right Table of Contents (for the current page).</p>
                    <ul>
                        <li><strong>Header:</strong> Contains the logo, site title, and theme toggle.</li>
                        <li><strong>Left Sidebar:</strong> Accordion-style navigation for different sections/pages of the documentation.</li>
                        <li><strong>Main Content:</strong> The actual documentation text, code examples, etc.</li>
                        <li><strong>Right Sidebar:</strong> Dynamically generated Table of Contents based on H1 and H2 tags in the main content.</li>
                    </ul>
                </section>
                <section id="state-management">
                    <h2 id="state-management-sub">State Management</h2>
                    <p>For this simple example, state management is minimal. The theme (dark/light) is stored in <code>localStorage</code>. Active accordion states are managed via CSS classes toggled by JavaScript.</p>
                    <p>In a more complex application, you might use a dedicated state management library or pattern.</p>
                    <table>
                        <thead> <tr> <th>Feature</th> <th>State Mechanism</th> <th>Persistence</th> </tr> </thead>
                        <tbody>
                            <tr> <td>Theme</td> <td>CSS Class on <code><body></code>, JS Toggle</td> <td><code>localStorage</code></td> </tr>
                            <tr> <td>Accordion</td> <td>CSS Class on elements, JS Toggle</td> <td>Session only</td> </tr>
                            <tr> <td>Active Nav Link</td> <td>CSS Class, JS Logic (simple href match)</td> <td>Session only</td> </tr>
                        </tbody>
                    </table>
                </section>
                <section id="api-overview">
                    <h1>API Reference</h1>
                    <h2 id="endpoints">Endpoints & Authentication</h2>
                    <p>This section would typically detail your project's API if it had one. For now, it's placeholder content.</p>
                    <p>Consider the following structure for API documentation:</p>
                    <h3>GET /users</h3>
                    <p>Retrieves a list of users.</p>
                    <p><strong>Parameters:</strong></p>
                    <ul> <li><code>page</code> (optional, integer): The page number for pagination.</li> <li><code>limit</code> (optional, integer): Number of items per page.</li> </ul>
                    <pre><code class="language-json"> // Example Response
{
  "data": [
    { "id": 1, "name": "Alice" },
    { "id": 2, "name": "Bob" }
  ],
  "meta": { "currentPage": 1, "totalPages": 5 }
} </code></pre>
                     <h2 id="authentication">Authentication</h2>
                     <p>Authentication is handled via API keys passed in the <code>Authorization</code> header.</p>
                     <pre><code>Authorization: Bearer YOUR_API_KEY</code></pre>
                </section>
                 <section id="performance">
                    <h1>Advanced Topics</h1>
                    <h2 id="security">Performance & Security</h2>
                    <p>This section will cover more advanced topics related to the project.</p>
                     <h3>Performance Considerations</h3>
                     <p>Ensure images are optimized, and JavaScript is minified for production environments. Leverage browser caching where appropriate.</p>
                     <h3 id="deployment">Deployment</h3>
                     <p>For a static site like this example, deployment can be as simple as uploading the HTML file to a web server or using services like GitHub Pages, Netlify, or Vercel.</p>
                </section>
            </article>
        </main>

        <aside class="right-sidebar">
            <h4>On This Page</h4>
            <ul id="toc-list"></ul>
        </aside>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const headerHeight = 64;
            const scrollOffset = headerHeight + 16;

            // Theme Toggle
            const themeToggleBtn = document.getElementById('theme-toggle');
            const themeIcon = document.getElementById('theme-icon');
            const currentTheme = localStorage.getItem('theme');
            const setIconForTheme = (isDark) => themeIcon.setAttribute('icon', isDark ? 'mdi:weather-night' : 'mdi:weather-sunny');
            if (currentTheme === 'dark') {
                document.body.classList.add('dark-theme'); setIconForTheme(true);
            } else { setIconForTheme(false); }
            themeToggleBtn.addEventListener('click', () => {
                document.body.classList.toggle('dark-theme');
                let theme = document.body.classList.contains('dark-theme') ? 'dark' : 'light';
                localStorage.setItem('theme', theme); setIconForTheme(theme === 'dark');
            });

            // Accordion
            const accordionHeaders = document.querySelectorAll('.left-sidebar .accordion-header');
            accordionHeaders.forEach(header => {
                header.addEventListener('click', () => {
                    const content = header.nextElementSibling;
                    const arrowIcon = header.querySelector('.arrow iconify-icon');
                    header.classList.toggle('active-accordion-header');
                    if (content.style.maxHeight) {
                        content.style.maxHeight = null;
                        if(arrowIcon) arrowIcon.setAttribute('icon', 'mdi:chevron-right');
                    } else {
                        content.style.maxHeight = content.scrollHeight + "px";
                        if(arrowIcon) arrowIcon.setAttribute('icon', 'mdi:chevron-down');
                    }
                });
            });

            // ToC Generation
            const tocList = document.getElementById('toc-list');
            const mainContentArticle = document.querySelector('.main-content article');
            if (tocList && mainContentArticle) {
                const headings = mainContentArticle.querySelectorAll('h1, h2');
                let tocHTML = '';
                const slugify = t => t.toString().toLowerCase().replace(/\s+/g,'-').replace(/[^\w\-]+/g,'').replace(/\-\-+/g,'-').replace(/^-+/,'').replace(/-+$/,'');
                headings.forEach(h => {
                    const lvl = h.tagName.toLowerCase(), txt = h.textContent;
                    let id = h.id || slugify(txt); h.id = id;
                    tocHTML += `<li class="toc-${lvl}"><a href="#${id}">${txt}</a></li>`;
                });
                tocList.innerHTML = tocHTML;
            }

            // Active ToC Link Highlighting
            const tocLinks = tocList ? tocList.querySelectorAll('a') : [];
            const contentHeadings = mainContentArticle ? Array.from(mainContentArticle.querySelectorAll('h1, h2')) : [];
            const makeTocLinkActive = link => { tocLinks.forEach(l => l.classList.remove('toc-active')); if(link) link.classList.add('toc-active'); };
            tocLinks.forEach(link => link.addEventListener('click', e => makeTocLinkActive(link)));
            const onScrollTocHighlight = () => {
                if (!tocList || contentHeadings.length === 0) return;
                let current = null; const detectionOffset = scrollOffset + 10;
                for (let i = contentHeadings.length - 1; i >= 0; i--) {
                    if (contentHeadings[i].getBoundingClientRect().top < detectionOffset) { current = contentHeadings[i]; break; }
                }
                if (!current && contentHeadings.length > 0 && window.scrollY < 200) current = contentHeadings[0];
                if (window.innerHeight + window.scrollY >= document.body.offsetHeight - 50) current = contentHeadings[contentHeadings.length - 1];
                makeTocLinkActive(current ? tocList.querySelector(`a[href="#${current.id}"]`) : null);
            };
            window.addEventListener('scroll', onScrollTocHighlight, { passive: true });
            onScrollTocHighlight();

            // Active Nav Link & Accordion Auto-Open
            const navLinks = document.querySelectorAll('.left-sidebar .nav-link');
            const updateActiveNavLinkAndAccordion = () => {
                const currentHash = window.location.hash; let activeAccordionHeader = null;
                navLinks.forEach(link => {
                    if (link.getAttribute('href') === currentHash) {
                        link.classList.add('active-nav-link');
                        const content = link.closest('.accordion-content');
                        if (content) activeAccordionHeader = content.previousElementSibling;
                    } else { link.classList.remove('active-nav-link'); }
                });
                accordionHeaders.forEach(header => {
                    const content = header.nextElementSibling, arrow = header.querySelector('.arrow iconify-icon');
                    if (header === activeAccordionHeader) {
                        if (!header.classList.contains('active-accordion-header')) {
                            header.classList.add('active-accordion-header'); content.style.maxHeight = content.scrollHeight + "px";
                            if (arrow) arrow.setAttribute('icon', 'mdi:chevron-down');
                        }
                    } else if (header.classList.contains('active-accordion-header')) {
                        header.classList.remove('active-accordion-header'); content.style.maxHeight = null;
                        if (arrow) arrow.setAttribute('icon', 'mdi:chevron-right');
                    }
                });
                if (currentHash) {
                    const target = document.getElementById(currentHash.substring(1));
                    if (target) setTimeout(() => window.scrollTo({ top: target.getBoundingClientRect().top + window.pageYOffset - scrollOffset, behavior: 'auto' }), 50);
                }
            };
            window.addEventListener('hashchange', updateActiveNavLinkAndAccordion);
            updateActiveNavLinkAndAccordion();

            // Search Focus (Ctrl+K, /) and Animation, Escape to blur
            const searchInput = document.getElementById('search-input');
            const searchWidgetContainer = document.getElementById('search-widget-container');
            if (searchInput && searchWidgetContainer) {
                searchInput.addEventListener('focus', () => searchWidgetContainer.classList.add('search-container--focused'));
                searchInput.addEventListener('blur', () => searchWidgetContainer.classList.remove('search-container--focused'));
                
                // Listener for Ctrl+K and / to focus
                document.addEventListener('keydown', (e) => {
                    const targetNode = e.target.nodeName.toLowerCase();
                    const isInputFocused = targetNode === 'input' || targetNode === 'textarea' || e.target.isContentEditable;
                    
                    if (((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 'k') || (e.key === '/' && !isInputFocused)) {
                        e.preventDefault(); 
                        searchInput.focus();
                    }
                });

                // Listener for Esc to blur search input
                searchInput.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        searchInput.blur();
                    }
                });
            }
        });
    </script>
</body>
</html>